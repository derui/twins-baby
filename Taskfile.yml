version: '3'

tasks:
  default:
    cmds:
      - task --list

  lint:
    desc: lint and format code
    cmds:
      - cargo fmt
      - cargo clippy --fix --allow-dirty --allow-staged --workspace
      - leptosfmt '**/*.rs$'

  test:
    desc: Run test all workspace
    cmds:
      - cargo nextest run --workspace {{.CLI_ARGS}}

  test:e2e:
    desc: Run Playwright browser tests
    env:
      PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD: "1"
    cmds:
      - bun --bun playwright test {{.CLI_ARGS}}

  test:e2e:ui:
    desc: Run Playwright browser tests with interactive UI
    env:
      PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD: "1"
    cmds:
      - bun --bun playwright test --ui
